#!/bin/bash
#
# Authors:
#	Sam Hewitt <hewittsamuel@gmail.com> (original script)
#	Alfredo Hernández <aldomann.designs@gmail.com>
#
# Description:
#	A post-installation bash script for Antergos
#
# Legal Stuff:
#	This script is free software: you can redistribute it and/or modify
#	it under the terms of the GNU General Public License as published by
#	the Free Software Foundation, version 3.

#	This script is distributed in the hope that it will be useful,
#	but WITHOUT ANY WARRANTY; without even the implied warranty of
#	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
#	GNU General Public License for more details.

#	You should have received a copy of the GNU General Public License
#	along with this script. If not, see <http://www.gnu.org/licenses/>.

tabs 2
clear

echo "#--------------------------------------------#"
echo "#        Antergos Post-Install Script        #"
echo "#--------------------------------------------#"

#----- FUNCTIONS -----#
function sysupgrade {
	# Perform system upgrade
	echo
	show_info 'Performing system upgrade...'
	yay -Syyu --combinedupgrade
	if [ -a /var/lib/pacman/db.lck ]; then
		sudo rm /var/lib/pacman/db.lck
	fi
	show_success 'Done.'
	notify-send "System upgrade was successful" -i system-software-update
	exit
}
# ----------------------------------------------------------------------
function applications {
	show_info 'What would you like to do?'
	echo
	# echo "0) Perform system update and upgrade?"
	echo "1) Install standard application groups?"
	echo "2) Install standard standalone applications?"
	echo "3) Install Flatpak applications?"
	echo "4) Install AUR applications?"
	echo
	echo "r) Return?"
	echo
	show_info 'Enter your choice:' && read REPLY
	case $REPLY in
		1) clear && apps-groups;;     # Install standard apps
		2) clear && apps-standalone;; # Install standard apps
		3) clear && apps-flatpak;;    # Install Flatpak apps
		4) clear && apps-aur;;        # Install AUR apps
		[Rr]*) clear && main;;        # Return
		# Invalid choice
		* ) clear && show_error 'Not an option, try again.' && applications;;
	esac
}

# ----------------------------------------------------------------------
function apps-groups {
	show_info 'What would you like to do?'
	echo
	echo "0) Set up Pacman configuration?"
	echo
	echo "1) Install basic apps?         [27]"
	echo "2) Install basic games?        [4]"
	echo "3) Install development tools?  [11]"
	echo "4) Install exclusive apps?     [29]"
	echo "5) Install exclusive games?    [5]"
	echo "6) Install energy saving apps? [5]"
	echo "7) Install Qt config tools?    [3]"
	echo
	echo "u) Uninstall unused apps?      [16]"
	echo
	echo "r) Return?"
	echo
	show_info 'Enter your choice:' && read REPLY
	case $REPLY in
	# Set up Pacman configuration
	0)
		show_info 'Seting up Pacman configuration...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo sed -i 's@#CacheDir.*@CacheDir    = /tmp@g' /etc/pacman.conf
			if [ -d /var/cache/pacman ]; then
				sudo rm -rf /var/cache/pacman
			fi
			sudo sed -i 's@#Color@Color@g' /etc/pacman.conf
			sudo sed -i ':a;N;$!ba;s@#\[multilib\]\n#Include = /etc/pacman.d/mirrorlist@\[multilib\]\nInclude = /etc/pacman.d/mirrorlist@g' /etc/pacman.conf
			clear && apps-groups
			;;
		# Negative action
		[Nn]* )
			clear && apps-groups
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-groups
			;;
		esac
		;;
	# Install basic apps
	1)
		show_info 'Installing basic apps...'
		echo
		echo "Current package list: arc-gtk-theme bleachbit chrome-gnome-shell ffmpegthumbnailer gvfs-goa gvfs-google icedtea-web jre8-openjdk libappindicator-gtk3 mlocate mpv noto-fonts-emoji onlyoffice p7zip pepper-flash reflector simple-scan subdl tilix transmission-cli yay aspell-ca aspell-en aspell-es hunspell-en_GB hunspell-en_US hunspell-es_es"
		# [Not installed]: gbrainy sound-juicer
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S arc-gtk-theme bleachbit chrome-gnome-shell ffmpegthumbnailer gvfs-goa gvfs-google icedtea-web jre8-openjdk libappindicator-gtk3 mlocate mpv noto-fonts-emoji onlyoffice p7zip pepper-flash reflector simple-scan subdl tilix transmission-cli yay aspell-ca aspell-en aspell-es hunspell-en_GB hunspell-en_US hunspell-es_es --needed
			notify-send "Installation was successful"
			clear && apps-groups
			;;
		# Negative action
		[Nn]* )
			clear && apps-groups
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-groups
			;;
		esac
		;;
	# Install basic games
	2)
		show_info 'Installing basic games...'
		echo
		echo "Current package list: aisleriot gnome-mahjongg gnome-mines quadrapassel"
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S aisleriot gnome-mahjongg gnome-mines quadrapassel --needed
			notify-send "Installation was successful"
			clear && apps-groups
			;;
		# Negative action
		[Nn]* )
			clear && apps-groups
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-groups
			;;
		esac
		;;
	# Install development tools
	3)
		show_info 'Installing development tools...'
		echo
		echo "Current package list: android-tools base-devel bzr fiji-bin gcc-fortran gdal git rstudio-desktop sublime-merge sublime-text vim"
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S android-tools base-devel bzr fiji-bin gcc-fortran gdal git rstudio-desktop sublime-merge sublime-text vim --needed
			notify-send "Installation was successful"
			clear && apps-groups
			;;
		# Negative action
		[Nn]* )
			clear && apps-groups
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-groups
			;;
		esac
		;;
	# Install exclusive apps
	4)
		show_info 'Installing exclusive apps...'
		echo
		echo "Current package list: adobe-source-han-sans-otc-fonts colordiff dconf-editor dosbox fdupes filemanager-actions flatpak flatpak-builder fluidsynth fractal fwupd gaupol gimp gnome-characters gnome-clocks gnome-epub-thumbnailer gnome-usage hamster-time-tracker inkscape mkvtoolnix-cli pdftk pngquant pulseeffects python2-nautilus sigil soundfont-fluid sshpass vnstat youtube-dl"
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S adobe-source-han-sans-otc-fonts colordiff dconf-editor dosbox fdupes filemanager-actions flatpak flatpak-builder fluidsynth fractal fwupd gaupol gimp gnome-characters gnome-clocks gnome-epub-thumbnailer gnome-usage hamster-time-tracker inkscape mkvtoolnix-cli pngquant pulseeffects python2-nautilus sigil soundfont-fluid sshpass vnstat youtube-dl --needed
			notify-send "Installation was successful"
			clear && apps-groups
			;;
		# Negative action
		[Nn]* )
			clear && apps-groups
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-groups
			;;
		esac
		;;
	# Install exclusive games
	5)
		show_info 'Installing exclusive games...'
		echo
		echo "Current package list: dolphin-emu gameconqueror retroarch steam steam-native-runtime"
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S dolphin-emu gameconqueror retroarch steam steam-native-runtime --needed
			notify-send "Installation was successful"
			clear && apps-groups
			;;
		# Negative action
		[Nn]* )
			clear && apps-groups
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-groups
			;;
		esac
		;;
	# Install energy saving apps
	6)
		show_info 'Installing energy saving apps...'
		echo
		echo "Current package list: gnome-power-manager powertop tlp tlp-rdw acpi_call-dkms"
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S gnome-power-manager powertop tlp tlp-rdw acpi_call-dkms --needed
			notify-send "Installation was successful"
			clear && apps-groups
			;;
		# Negative action
		[Nn]* )
			clear && apps-groups
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-groups
			;;
		esac
		;;
	# Install Qt config tools
	7)
		show_info 'Installing Qt config tools...'
		echo
		echo "Current package list: kde-gtk-config qt5ct qt5-styleplugins"
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S kde-gtk-config qt5ct qt5-styleplugins --needed
			notify-send "Installation was successful"
			clear && apps-groups
			;;
		# Negative action
		[Nn]* )
			clear && apps-groups
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-groups
			;;
		esac
		;;
	# Uninstall apps
	[Uu]*)
		show_info 'Uninstalling unused apps...'
		echo
		echo "Current package list: brasero chromium gedit gnome-contacts gnome-documents gnome-maps gnome-music gnome-photos gnome-sound-recorder gnome-weather htop numix-frost-themes numix-icon-theme numix-icon-theme-square polari totem"
		# EXCLUSIVE: gedit sound-juicer
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -R antergos-common-meta antergos-gnome-meta;
			sudo pacman -Rncs brasero chromium gedit gnome-contacts gnome-documents gnome-maps gnome-music gnome-photos gnome-sound-recorder gnome-weather htop numix-frost-themes numix-icon-theme numix-icon-theme-square polari totem
			notify-send "Uninstallation was successful"
			clear && apps-groups
			;;
		# Negative action
		[Nn]* )
			clear && apps-groups
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-groups
			;;
		esac
		;;
	# Return
	[Rr]*)
		clear && applications;;
	# Invalid choice
	* )
		clear && show_error 'Not an option, try again.' && apps-groups;;
	esac
}
# ----------------------------------------------------------------------
function apps-standalone {
	show_info 'What would you like to do?'
	echo
	echo "1) Install GDM?"
	echo "2) Install Oh My Zsh?"
	echo "3) Install Sublime Text?"
	echo "4) Install Wine?"
	echo "5) Install TeXLive?"
	echo "6) Install VirtualBox?"
	echo
	echo "r) Return?"
	echo
	show_info 'Enter your choice:' && read REPLY
	case $REPLY in
	# Install GDM
	1)
		show_info 'Installing GDM...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			# SRC: http://drunkensloth.weebly.com/home/how-to-switch-from-lightdm-to-gdm-or-any-other-display-manager-on-antergos-or-arch-linux
			sudo pacman -S gdm --needed
			sudo systemctl disable lightdm.service
			sudo systemctl enable gdm.service
			PKG="lightdm"
			if [[ -n $(pacman -Qs $PKG) ]]; then
				sudo pacman -Rncs $PKG
			fi
			clear && apps-standalone
			;;
		# Negative action
		[Nn]* )
			clear && apps-standalone
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-standalone
			;;
		esac
		;;
	# Install Oh My Zsh
	2)
		show_info 'Installing Oh My Zsh...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			# SRC: https://github.com/robbyrussell/oh-my-zsh
			sudo pacman -S zsh --needed
			sh -c "$(wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)"
			clear && apps-standalone
			;;
		# Negative action
		[Nn]* )
			clear && apps-standalone
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-standalone
			;;
		esac
		;;
	# Install Sublime Text
	3)
		show_info 'Installing Sublime Text...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			# Install the GPG key
			curl -O https://download.sublimetext.com/sublimehq-pub.gpg && sudo pacman-key --add sublimehq-pub.gpg && sudo pacman-key --lsign-key 8A8F901A && rm sublimehq-pub.gpg
			# Enable Stable Channel
			echo -e "\n[sublime-text]\nServer = https://download.sublimetext.com/arch/stable/x86_64" | sudo tee -a /etc/pacman.conf
			sudo pacman -Syy
			sudo pacman -S sublime-text
			clear && apps-standalone
			;;
		# Negative action
		[Nn]* )
			clear && apps-standalone
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-standalone
			;;
		esac
		;;
	# Install Wine
	4)
		show_info 'Installing Wine...'
		echo
		echo "Current package list: wine-staging wine-mono wine_gecko winetricks"
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S wine-staging wine-mono wine_gecko winetricks --needed
			notify-send "Installation was successful"
			clear && apps-standalone
			;;
		# Negative action
		[Nn]* )
			clear && apps-standalone
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-standalone
			;;
		esac
		;;
	# Install TeXLive
	5)
		show_info 'Installing TeXLive...'
		echo
		echo "Current package list: texlive-most"
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S texlive-most
			notify-send "Installation was successful"
			clear && apps-standalone
			;;
		# Negative action
		[Nn]* )
			clear && apps-standalone
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-standalone
			;;
		esac
		;;
	# Install VirtualBox
	6)
		show_info 'Installing VirtualBox...'
		echo
		echo "Current package list: virtualbox virtualbox-guest-modules-arch virtualbox-host-modules-arch"
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S virtualbox virtualbox-guest-modules-arch virtualbox-host-modules-arch --needed
			notify-send "Installation was successful"
			clear && apps-standalone
			;;
		# Negative action
		[Nn]* )
			clear && apps-standalone
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-standalone
			;;
		esac
		;;
	# Uninstall apps
	[Uu]*)
		show_info 'Uninstalling unused apps...'
		echo
		echo "Current package list: brasero chromium gedit gnome-contacts gnome-documents gnome-maps gnome-music gnome-photos gnome-sound-recorder gnome-weather htop numix-frost-themes numix-icon-theme numix-icon-theme-square polari totem"
		# EXCLUSIVE: gedit sound-juicer
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -R antergos-common-meta antergos-gnome-meta;
			sudo pacman -Rncs brasero chromium gedit gnome-contacts gnome-documents gnome-maps gnome-music gnome-photos gnome-sound-recorder gnome-weather htop numix-frost-themes numix-icon-theme numix-icon-theme-square polari totem
			notify-send "Uninstallation was successful"
			clear && apps-standalone
			;;
		# Negative action
		[Nn]* )
			clear && apps-standalone
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-standalone
			;;
		esac
		;;
	# Return
	[Rr]*)
		clear && applications;;
	# Invalid choice
	* )
		clear && show_error 'Not an option, try again.' && apps-standalone;;
	esac
}
# ----------------------------------------------------------------------
function apps-flatpak {
	show_info 'What would you like to do?'
	echo
	echo "0) Set up Flatpak repositories?"
	echo
	echo "1) Install basic apps?    [6]"
	echo "2) Uninstall unused apps?"
	echo
	echo "r) Return?"
	echo
	show_info 'Enter your choice:' && read REPLY
	case $REPLY in
	# Set up Pacman configuration
	0)
		show_info 'Seting up Flatpak repositories...'
		echo
		echo 'Current repos list: gnome.flatpakrepo flathub.flatpakrep'
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			flatpak remote-add --from gnome https://sdk.gnome.org/gnome.flatpakrepo
			flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
			clear && apps-flatpak
			;;
		# Negative action
		[Nn]* )
			clear && apps-flatpak
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-flatpak
			;;
		esac
		;;
	# Install basic apps
	1)
		show_info 'Installing basic apps...'
		echo
		echo "Current package list: com.discordapp.Discord com.googleplaymusicdesktopplayer.GPMDP com.skype.Client org.gnome.Podcasts"
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			flatpak install flathub \
			com.discordapp.Discord \
			com.elsevier.MendeleyDesktop \
			com.github.needleandthread.vocal \
			com.googleplaymusicdesktopplayer.GPMDP \
			com.skype.Client \
			org.gnome.Podcasts
			notify-send "Installation was successful"
			clear && apps-flatpak
			;;
		# Negative action
		[Nn]* )
			clear && apps-flatpak
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-flatpak
			;;
		esac
		;;
	# Install basic apps
	2)
		show_info 'Uninstalling unused apps...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			flatpak uninstall --unused
			clear && apps-flatpak
			;;
		# Negative action
		[Nn]* )
			clear && apps-flatpak
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && apps-flatpak
			;;
		esac
		;;
	# Return
	[Rr]*)
		clear && applications;;
	# Invalid choice
	* )
		clear && show_error 'Not an option, try again.' && apps-flatpak;;
	esac
}
# ----------------------------------------------------------------------
function fix-apps {
	show_info 'What would you like to do?'
	echo
	echo "0) Fix GDM scaling factor?"
	echo "1) Use symbolic icons in Inkscape?"
	echo "2) Enable smooth fonts in Wine?"
	echo "3) Enable coloured emojis?"
	echo
	echo "4) Add hidden .desktop files?"
	echo "5) Add extra .desktop files?"
	echo "6) Set up GNOME Shell app folders?"
	echo "7) Replace Synaptics for libinput?"
	echo
	echo "r) Return?"
	echo
	show_info 'Enter your choice:' && read REPLY
	case $REPLY in
	# GDM scaling factor
	0)
		show_info 'Applying fix for GDM...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo awk -v RS="\0" -v ORS="" '{gsub("<key name=\"scaling-factor\" type=\"u\">\n      <default>2</default>", "<key name=\"scaling-factor\" type=\"u\">\n      <default>1</default>")}7' /usr/share/glib-2.0/schemas/org.gnome.desktop.interface.gschema.xml
			sudo glib-compile-schemas /usr/share/glib-2.0/schemas
			notify-send "GDM" "Scaling factor has been fixed" -i system-lock-screen
			clear && fix-apps
			;;
		# Negative action
		[Nn]* )
			clear && fix-apps
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && fix-apps
			;;
		esac
		;;
	# Inkscape icons
	1)
		show_info 'Applying fix for Inkscape...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			# Backup icons.svg
				sudo mv '/usr/share/inkscape/icons/icons_backup.svg' '/usr/share/inkscape/icons/icons.svg'
				sudo cp '/usr/share/inkscape/icons/icons.svg' '/usr/share/inkscape/icons/icons_backup.svg'
				sudo cp '/usr/share/inkscape/icons/symbolic_icons.svg' '/usr/share/inkscape/icons/icons.svg'
			notify-send "Inkscape" "Symbolic icons have been installed successfully" -i inkscape
			clear && fix-apps
			;;
		# Negative action
		[Nn]* )
			clear && fix-apps
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && fix-apps
			;;
		esac
		;;
	# Wine fonts
	2)
		show_info 'Applying fix for Wine...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			# SRC: http://files.polosatus.ru/winefontssmoothing_en.sh
			WINE=${WINE:-wine}
			WINEPREFIX=${WINEPREFIX:-$HOME/.wine}
			DIALOG=whiptail
			if [ ! -x "`which "$WINE"`" ]; then
				show_error "Wine was not found. Is it really installed? ($WINE)"
				exit 1
			fi
			if [ ! -x "`which "$DIALOG"`" ]; then
				DIALOG=dialog
			fi
			TMPFILE=`mktemp` || exit 1
			$DIALOG --menu \
				"Please select font smoothing mode for wine programs:" 13 51\
				4\
					1 "Smoothing disabled"\
					2 "Grayscale smoothing"\
					3 "Subpixel smoothing (ClearType) RGB"\
					4 "Subpixel smoothing (ClearType) BGR" 2> $TMPFILE
			STATUS=$?
			ANSWER=`cat $TMPFILE`
			if [ $STATUS != 0 ]; then
				rm -f $TMPFILE
				exit 1
			fi
			MODE=0 # 0 = disabled; 2 = enabled
			TYPE=0 # 1 = regular;  2 = subpixel
			ORIENTATION=1 # 0 = BGR; 1 = RGB
			case $ANSWER in
				1) # disable
					;;
				2) # enable
					MODE=2
					TYPE=1
					;;
				3) # enable cleartype rgb
					MODE=2
					TYPE=2
					;;
				4) # enable cleartype bgr
					MODE=2
					TYPE=2
					ORIENTATION=0
					;;
				*)
					rm -f $TMPFILE
					echo Unexpected option: $ANSWER
					exit 1
					;;
			esac
			echo "REGEDIT4" > $TMPFILE
			echo "[HKEY_CURRENT_USER\Control Panel\Desktop]" >> $TMPFILE
			echo "\"FontSmoothing\"=\"$MODE\"" >> $TMPFILE
			echo "\"FontSmoothingOrientation\"=dword:0000000$ORIENTATION" >> $TMPFILE
			echo "\"FontSmoothingType\"=dword:0000000$TYPE" >> $TMPFILE
			echo "\"FontSmoothingGamma\"=dword:00000578" >> $TMPFILE
			show_info "Updating configuration..."
			$WINE regedit $TMPFILE 2> /dev/null
			rm -f $TMPFILE

			notify-send "Wine" "Font rendering has been fixed successfully" -i wine
			clear && fix-apps
			;;
		# Negative action
		[Nn]* )
			clear && fix-apps
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && fix-apps
			;;
		esac
		;;
	# Coloured emojis
	3)
		# SRC: https://www.reddit.com/r/archlinux/comments/52k3t0/proper_color_emoji_support/d7l05nt
		# TEST: https://eosrei.github.io/emojione-color-font/full-demo.html
		show_info 'Installing and setting up noto-fonts-emoji...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S noto-fonts-emoji --needed
			echo '<?xml version="1.0"?>' > ~/.config/fontconfig/conf.d/01-emoji.conf
			echo '<!DOCTYPE fontconfig SYSTEM "fonts.dtd">' >> ~/.config/fontconfig/conf.d/01-emoji.conf
			echo '<fontconfig>' >> ~/.config/fontconfig/conf.d/01-emoji.conf
			echo '  <!-- Use Google Emojis -->' >> ~/.config/fontconfig/conf.d/01-emoji.conf
			echo '  <match target="pattern">' >> ~/.config/fontconfig/conf.d/01-emoji.conf
			echo '    <test qual="any" name="family"><string>Segoe UI Emoji</string></test>' >> ~/.config/fontconfig/conf.d/01-emoji.conf
			echo '    <edit name="family" mode="assign" binding="same"><string>Noto Color Emoji</string></edit>' >> ~/.config/fontconfig/conf.d/01-emoji.conf
			echo '  </match>' >> ~/.config/fontconfig/conf.d/01-emoji.conf
			echo '</fontconfig>' >> ~/.config/fontconfig/conf.d/01-emoji.conf

			clear && fix-apps
			;;
		# Negative action
		[Nn]* )
			clear && fix-apps
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && fix-apps
			;;
		esac
		;;
	# Hidden desktop files
	4)
		show_info 'Adding hidden desktop files...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			# Hidden Desktops
				cd /tmp
				wget https://www.dropbox.com/s/ic9uim3efnkuxpa/hidden-apps.tar.xz
				tar xf hidden-apps.tar.xz
				cd hidden-apps
				cp -r *.desktop $HOME/.local/share/applications
			gtk-update-icon-cache
			clear && fix-apps
			;;
		# Negative action
		[Nn]* )
			clear && fix-apps
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && fix-apps
			;;
		esac
		;;
	# Extra desktop files
	5)
		show_info 'Adding hidden desktop files...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			# Extra Desktops
				cd /tmp
				wget https://www.dropbox.com/s/h48ukig4kyb3kjs/changed-apps.tar.xz
				tar xf changed-apps.tar.xz
				cd changed-apps
				cp -r *.desktop $HOME/.local/share/applications
			gtk-update-icon-cache
			clear && fix-apps
			;;
		# Negative action
		[Nn]* )
			clear && fix-apps
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && fix-apps
			;;
		esac
		;;
	# GNOME Shell app folders
	6)
		show_info 'Changing dconf files...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			show_info 'In which language is your system? (E)nglish or (S)panish: ' && read REPLY
			case $REPLY in
			# English
			[Ee]* )
				books_appfolder="Books"
				games_appfolder="Games"
				graphics_appfolder="Graphics"
				media_appfolder="Media"
				office_appfolder="Office"
				organisation_appfolder="Organisation"
				programming_appfolder="Programming"
				social_appfolder="Social"
				utilities_appfolder="Utilities"
				dconf write /org/gnome/desktop/app-folders/folder-children "['Books', 'Games', 'Graphics' ,'Media', 'Office', 'Organization', 'Programming', 'Social', 'Utilities']"
				;;
			# Spanish
			[Ss]* )
				books_appfolder="Libros"
				games_appfolder="Juegos"
				graphics_appfolder="Gráficos"
				media_appfolder="Multimedia"
				office_appfolder="Ofimática"
				organisation_appfolder="Organización"
				programming_appfolder="Progración"
				social_appfolder="Social"
				utilities_appfolder="Utilidades"
				dconf write /org/gnome/desktop/app-folders/folder-children "['Games', 'Office', 'Utilities']"
				;;
			esac
			dconf write /org/gnome/desktop/app-folders/folders/Books/name "'$books_appfolder'"
			dconf write /org/gnome/desktop/app-folders/folders/Games/name "'$games_appfolder'"
			dconf write /org/gnome/desktop/app-folders/folders/Graphics/name "'$graphics_appfolder'"
			dconf write /org/gnome/desktop/app-folders/folders/Media/name "'$media_appfolder'"
			dconf write /org/gnome/desktop/app-folders/folders/Utilities/name "'$utilities_appfolder'"
			dconf write /org/gnome/desktop/app-folders/folders/Office/name "'$office_appfolder'"
			dconf write /org/gnome/desktop/app-folders/folders/Organization/name "'$organisation_appfolder'"
			dconf write /org/gnome/desktop/app-folders/folders/Social/name "'$social_appfolder'"
			dconf write /org/gnome/desktop/app-folders/folders/Programming/name "'$programming_appfolder'"

			dconf write /org/gnome/desktop/app-folders/folders/Books/apps "['adobe-digital-editions.desktop', 'calibre-gui.desktop', 'com.github.babluboy.bookworm.desktop', 'com.github.johnfactotum.Foliate.desktop', 'mcomix.desktop', 'org.gnome.Books.desktop', 'sigil.desktop', 'YACReader.desktop', 'YACReaderLibrary.desktop']"
			dconf write /org/gnome/desktop/app-folders/folders/Games/apps "['five-or-more.desktop', 'four-in-a-row.desktop', 'gnome-chess.desktop', 'gnome-klotski.desktop', 'gnome-mahjongg.desktop', 'gnome-mines.desktop', 'gnome-robots.desktop', 'gnome-sudoku.desktop', 'gnome-tetravex.desktop', 'iagno.desktop', 'lightsoff.desktop', 'quadrapassel.desktop', 'sol.desktop', 'swell-foop.desktop', 'tali.desktop', 'org.gnome.gnome-2048.desktop', 'org.gnome.Hitori.desktop', 'org.gnome.Nibbles.desktop', 'org.gnome.taquin.desktop', 'dolphin-emu.desktop', 'emulationstation.desktop', 'retroarch.desktop', 'gvbam.desktop', 'zsnes.desktop', 'am2r.desktop', 'GameConqueror.desktop', 'gbrainy.desktop', 'hedgewars.desktop', 'minecraft.desktop', 'wesnoth-1.10.desktop', 'battlenet.desktop', 'Blizzard App.desktop', 'diablo.desktop', 'StarCraft.desktop', 'StarCraft II.desktop', 'war3.desktop', 'war3roc.desktop', 'war3tft.desktop', 'aoe2hd.desktop', 'civ4.desktop', 'aoe2hd-steam.desktop', 'civ4-steam.desktop', 'steam.desktop', 'steam-native.desktop', 'steam-wine.desktop', 'Portal 2 (Beta).desktop', 'teeworlds.desktop', 'Teeworlds.desktop', 'Torchlight II.desktop', 'World of Goo.desktop', 'Worms Reloaded.desktop', 'org.DolphinEmu.dolphin-emu.desktop']"
			dconf write /org/gnome/desktop/app-folders/folders/Graphics/apps "['eog.desktop', 'gimp.desktop', 'gravit-designer.desktop', 'inkscape.desktop', 'lightzone.desktop', 'nl.hjdskes.gcolor3.desktop', 'org.gimp.GIMP.desktop', 'org.gnome.Cheese.desktop', 'org.gnome.Screenshot.desktop', 'com.uploadedlobster.peek.desktop']"
			dconf write /org/gnome/desktop/app-folders/folders/Media/apps "['com.github.needle-and-thread.vocal.desktop', 'com.github.needleandthread.vocal.desktop', 'com.github.wwmm.pulseeffects.desktop', 'com.googleplaymusicdesktopplayer.GPMDP.desktop', 'org.gnome.FeedReader.desktop', 'com.vinszent.GnomeTwitch.desktop', 'chrome-fahmaaghhglfmonjliepjlchgpgfmobi-Default.desktop', 'chrome-cnciopoikihiagdjbjpnocolokfelagl-Default.desktop', 'gaupol.desktop', 'gnome-music.desktop', 'gnac.desktop', 'google-musicmanager.desktop', 'gpmdp.desktop', 'gradio.desktop', 'io.webtorrent.WebTorrent.desktop', 'lmms.desktop', 'mpv.desktop', 'org.gnome.Podcasts.desktop', 'popcorntime.desktop', 'sh.popcorntime.PopcornTime.desktop', 'smartcode-stremio.desktop', 'tvrenamer.desktop', 'vlc.desktop', 'webtorrent-desktop.desktop', 'qtwebflix.desktop', 'pocket-desktop.desktop', 'com.spotify.Client.desktop', 'org.gnome.SoundRecorder.desktop', 'io.otsaloma.gaupol.desktop']"
			dconf write /org/gnome/desktop/app-folders/folders/Office/apps "['chrome-aohghmighlieiainnegkcijnfilokake-Default.desktop', 'chrome-ejjicmeblgpmajnghnpcppodonldlgfn-Default.desktop', 'chrome-felcaaldnbdncclmgdcncolpebgiejap-Default.desktop', 'chrome-fnboaehgffehgoackjenbjcgcjeflddp-Default.desktop', 'chrome-hmjkmjkepdijhoojdojkdfohbdgmmhki-Default.desktop', 'chrome-ojcflmmmcfpacggndoaaflkmcoblhnbh-Default.desktop', 'chrome-aapocclcgogkmnckokdopfmhonfmgoek-Default.desktop', 'ao.desktop', 'bijiben.desktop', 'desktopeditors.desktop', 'dropbox.desktop', 'evolution-calendar.desktop', 'evolution.desktop', 'hamster-time-tracker.desktop', 'hamster-time-tracker-overview.desktop', 'insync.desktop', 'libreoffice-base.desktop', 'libreoffice-calc.desktop', 'libreoffice-draw.desktop', 'libreoffice-impress.desktop', 'libreoffice-math.desktop', 'libreoffice-startcenter.desktop', 'libreoffice-writer.desktop', 'masterpdfeditor.desktop', 'masterpdfeditor4.desktop', 'masterpdfeditor5.desktop', 'megasync.desktop', 'mendeleydesktop.desktop', 'com.elsevier.MendeleyDesktop.desktop', 'com.github.fabiocolacio.marker.desktop', 'org.gnome.Calendar.desktop', 'org.gnome.Contacts.desktop', 'org.gnome.Documents.desktop', 'org.gnome.Evince.desktop', 'org.gnome.Todo.desktop', 'pdftag.desktop', 'simple-scan.desktop', 'scantailor.desktop', 'org.onlyoffice.desktopeditors.desktop']"
			dconf write /org/gnome/desktop/app-folders/folders/Organization/apps "['appimagekit-easy-disk-cleaner.desktop', 'appimagekit-large-files-finder.desktop', 'appimagekit-speedy-duplicate-finder.desktop', 'bleachbit.desktop', 'org.gnome.baobab.desktop']"
			dconf write /org/gnome/desktop/app-folders/folders/Programming/apps "['cmake-gui.desktop', 'devdocs-desktop.desktop', 'glade.desktop', 'idea.desktop', 'lstopo.desktop', 'org.gnome.Builder.desktop', 'org.gnome.Devhelp.desktop', 'org.kde.kompare.desktop', 'sublime_merge.desktop', 'sublime_text.desktop', 'org.gnome.Sysprof2.desktop', 'anaconda-navigator.desktop', 'jupyter.desktop', 'jupyter-lab.desktop', 'imagej.desktop', 'matlab.desktop', 'panoply.desktop', 'pycharm-community.desktop', 'qtiplot.desktop', 'r.desktop', 'rstudio.desktop', 'spyder3.desktop', 'wolfram-mathematica11.desktop', 'wolfram-mathematica12.desktop', 'www.octave.org-octave.desktop', 'ImageJ2.desktop']"
			dconf write /org/gnome/desktop/app-folders/folders/Social/apps "['com.discordapp.Discord.desktop', 'com.github.bleakgrey.tootle.desktop', 'com.skype.Client.desktop', 'Discord.desktop', 'io.github.Hexchat.desktop', 'org.gnome.Fractal.desktop', 'org.gnome.Polari.desktop', 'rambox.desktop', 'skypeforlinux.desktop', 'slack.desktop', 'com.slack.Slack.desktop', 'telegramdesktop.desktop', 'whatsapp-nativefier.desktop', 'chrome-imgohncinckhbblnlmaedahepnnpmdma-Default.desktop']"
			dconf write /org/gnome/desktop/app-folders/folders/Utilities/apps "['chrome-oooiobdokpcfdlahlmcddobejikcmkfo-Default.desktop', 'com.teamviewer.TeamViewer.desktop', 'anydesk.desktop', 'com.anydesk.Anydesk.desktop', 'ca.desrt.dconf-editor.desktop', 'dosbox.desktop', 'gnome-appfolders-manager.desktop', 'gnome-power-statistics.desktop', 'gparted.desktop', 'fma-config-tool.desktop', 'imagewriter.desktop', 'indicator-kdeconnect.desktop', 'libinput-gestures.desktop', 'org.gnome.Boxes.desktop', 'org.gnome.DiskUtility.desktop', 'org.gnome.FileRoller.desktop', 'org.gnome.font-viewer.desktop', 'org.gnome.Logs.desktop', 'org.gnome.MultiWriter.desktop', 'org.gnome.PowerStats.desktop', 'org.gnome.Terminal.desktop', 'org.gnome.tweaks.desktop', 'org.gnome.Usage.desktop', 'org.kde.kdeconnect.kcm.desktop', 'pamac-manager.desktop', 'pamac-updater.desktop', 'qt5ct.desktop', 'qtconfig-qt4.desktop', 'redshift-gtk.desktop', 'seahorse.desktop', 'system76-driver.desktop', 'tor-browser.desktop', 'urserver.desktop', 'usb-creator-gtk.desktop', 'vineyard-preferences.desktop', 'virtualbox.desktop', 'wine-uninstaller.desktop', 'wine-winecfg.desktop', 'winetricks.desktop', 'org.gnome.Sysprof3.desktop', 'org.manjaro.pamac.manager.desktop']"

			clear && fix-apps
			;;
		# Negative action
		[Nn]* )
			clear && fix-apps
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && fix-apps
			;;
		esac
		;;
	# Replace Synaptics for libinput
	7)
		show_info 'Replacing Synaptics for libinput...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			sudo pacman -S xf86-input-libinput --needed
			PKG="xf86-input-synaptics"
			if [[ -n $(pacman -Qs $PKG) ]]; then
				sudo pacman -Rncs $PKG
			fi
			sudo rm -rf /etc/X11/xorg.conf.d/*synaptics*.conf
			clear && fix-apps
			;;
		# Negative action
		[Nn]* )
			clear && fix-apps
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && fix-apps
			;;
		esac
		;;
	# Return
	[Rr]*)
		clear && main;;
	# Invalid choice
	* )
		clear && show_error 'Not an option, try again.' && fix-apps;;
	esac
}
# ----------------------------------------------------------------------
function dconf-settings {
	show_info 'What would you like to do?'
	echo
	echo "1) Change background and lock wallpapers?"
	echo "2) Set up Nautilus layout?"
	echo "3) Show battery percentage in GNOME Shell?"
	echo "4) Change Night Light temperature?"
	echo
	echo "8) Set Moka/Arc/Roboto UI?"
	echo "9) Set Stock GNOME UI?"
	echo
	echo "r) Return?"
	echo
	show_info 'Enter your choice:' && read REPLY
	case $REPLY in
	# Backgrounds
	1)
		show_info 'Changing dconf files...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			dconf write /org/gnome/desktop/background/picture-uri "'file:///home/aldomann/Pictures/Wallpapers/back.jpg'"
			dconf write /org/gnome/desktop/screensaver/picture-uri "'file:///home/aldomann/Pictures/Wallpapers/lock.jpg'"
			clear && dconf-settings
			;;
		# Negative action
		[Nn]* )
			clear && dconf-settings
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && dconf-settings
			;;
		esac
		;;
	# Nautilus layout and preferences
	2)
		show_info 'Changing dconf files...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			# Regular nautilus
				dconf write /org/gnome/nautilus/icon-view/captions "['none', 'size', 'none']"
				dconf write /org/gnome/nautilus/icon-view/thumbnail-size "64"
				dconf write /org/gnome/nautilus/preferences/executable-text-activation "'ask'"
				# dconf write /org/gnome/nautilus/window-state/geometry "'1195x675+380+200'"
				dconf write /org/gnome/nautilus/window-state/sidebar-width "'155'"
				nautilus -q
			# Root nautilus
				sudo dconf write /org/gnome/nautilus/icon-view/captions "['none', 'size', 'none']"
				sudo dconf write /org/gnome/nautilus/icon-view/thumbnail-size "64"
				sudo dconf write /org/gnome/nautilus/preferences/executable-text-activation "'ask'"
				# sudo dconf write /org/gnome/nautilus/window-state/geometry "'1195x675+380+200'"
				# sudo dconf write /org/gnome/nautilus/window-state/sidebar-width "'155'"
			clear && dconf-settings
			;;
		# Negative action
		[Nn]* )
			clear && dconf-settings
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && dconf-settings
			;;
		esac
		;;
	# Show battery percentage
	3)
		show_info 'Changing dconf files...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			dconf write /org/gnome/desktop/interface/show-battery-percentage "true"
			clear && dconf-settings
			;;
		# Negative action
		[Nn]* )
			clear && dconf-settings
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && dconf-settings
			;;
		esac
		;;
	# Change Night Light temperature
	4)
		show_info 'Changing dconf files...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			dconf write /org/gnome/settings-daemon/plugins/color/night-light-temperature "uint32 5250"

			clear && dconf-settings
			;;
		# Negative action
		[Nn]* )
			clear && dconf-settings
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && dconf-settings
			;;
		esac
		;;
	# Moka/Arc UI
	8)
		show_info 'Changing dconf files...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			dconf write /org/gnome/desktop/wm/preferences/button-layout "':close'"
			dconf write /org/gnome/desktop/interface/font-name "'Roboto 11'"
			dconf write /org/gnome/desktop/interface/document-font-name "'Literata 11'"
			dconf write /org/gnome/desktop/interface/monospace-font-name "'Menlo 11'"
			dconf write /org/gnome/desktop/wm/preferences/titlebar-font "'Roboto Bold 11'"
			dconf write /org/gnome/desktop/interface/gtk-theme "'Arc-Darker'"
			dconf write /org/gnome/desktop/interface/icon-theme "'Moka'"
			clear && dconf-settings
			;;
		# Negative action
		[Nn]* )
			clear && dconf-settings
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && dconf-settings
			;;
		esac
		;;
	# Stock GNOME UI
	9)
		show_info 'Changing dconf files...'
		echo
		show_info 'Proceed? (Y)es, (N)o :' && read REPLY
		case $REPLY in
		# Positive action
		[Yy]* )
			dconf write /org/gnome/desktop/wm/preferences/button-layout "':close'"
			dconf write /org/gnome/desktop/interface/font-name "'Cantarell 11'"
			dconf write /org/gnome/desktop/wm/preferences/titlebar-font "'Cantarell Bold 11'"
			dconf write /org/gnome/desktop/interface/gtk-theme "'Adwaita'"
			dconf write /org/gnome/desktop/interface/icon-theme "'Adwaita'"
			clear && dconf-settings
			;;
		# Negative action
		[Nn]* )
			clear && dconf-settings
			;;
		# Error
		* )
			clear && show_error 'Sorry, try again.' && dconf-settings
			;;
		esac
		;;
	# Return
	[Rr]*)
		clear && main;;
	# Invalid choice
	* )
		clear && show_error 'Not an option, try again.' && dconf-settings;;
	esac
}
# ----------------------------------------------------------------------
function hardware {
	show_info 'What would you like to do?'
	echo
	echo "1) Show disk usage?"
	echo "2) Show kernel version?"
	echo "3) Show system controllers?"
	echo "4) Show CPU, RAM and architecture information?"
	echo
	echo "r) Return?"
	echo
	show_info 'Enter your choice:' && read REPLY
	case $REPLY in
	# Show disk usage
	1)
		lsblk
		echo
		df -h
		hardware
		;;
	# Show kernel version
	2)
		uname -r # uname -a shows kernel and arch info
		hardware
		;;
	# Show system information
	3)
		lspci -v
		hardware
		;;
	# Show CPU, RAM, arch information
	4)
		grep "model name" /proc/cpuinfo && grep MemTotal /proc/meminfo && lscpu
		hardware
		;;
	# Return
	[Rr]*)
		clear && main;;
	# Invalid choice
	* )
		clear && show_error 'Not an option, try again.' && hardware;;
	esac
}
# ----------------------------------------------------------------------
function cleanup {
	show_info 'What would you like to do?'
	echo
	echo "1) Remove orphaned packages?"
	echo "2) Clean package cache?"
	echo "3) List manually installed packages?"
	echo "4) List locally installed packages?"
	echo "5) Compare AUR backed up packages?"
	echo
	echo "r) Return?"
	echo
	show_info 'Enter your choice:' && read REPLY
	case $REPLY in
	# Remove orphaned packages
	1)
		#SRC: https://wiki.archlinux.org/index.php/Pacman/Tips_and_tricks#Removing_unused_packages_.28orphans.29
		if [[ ! -n $(yay -Qqdt) ]]; then
			show_success 'No orphans to remove.'
			if [[ -n $(yay -Qqdtt) ]]; then
				show_info "Optionally required packages: $(yay -Qqdtt)"
			fi
		else
			show_info 'Removing orphaned packages...'
			yay -Rns $(yay -Qqdt)
			show_success 'Done.'
		fi
		echo
		cleanup
		;;
	# Clean package cache (yay)
	2)
		show_info 'Cleaning package cache...'
		yay -Sc
		show_success 'Done.'
		echo
		cleanup
		;;
	# List manually installed packages
	3)
		show_info 'Listing packages...'
		yay -Qet
		show_success 'Done.'
		echo
		cleanup
		;;
	# List locally installed packages
	4)
		show_info 'Listing packages...'
		yay -Qm
		show_success 'Done.'
		echo
		cleanup
		;;
	# Compare AUR backed up packages
	5)
		show_info 'Listing packages...'
		yay -Qm | awk '{ gsub(" ","-"); print $0 }' > /tmp/local-list.txt
		ls -R $HOME/Downloads/Software/Installers/AUR -Iunused | awk '/.pkg.*/ { gsub("-x86_64.*",""); gsub("-any.*",""); gsub(".pkg.tar.xz",""); print $0}' | sort > /tmp/backup-list.txt
		colordiff /tmp/local-list.txt /tmp/backup-list.txt | less
		show_success 'Done.'
		echo
		cleanup
		;;
	# Return
	[Rr]*)
		clear && main;;
	# Invalid choice
	* )
		clear && show_error 'Not an option, try again.' && cleanup;;
	esac
}
# ----------------------------------------------------------------------

#----- MESSAGE FUNCTIONS -----#
show_info() {
	echo -e "\033[1;34m$@\033[0m"
}
show_success() {
	echo -e "\033[1;32m$@\033[0m"
}
show_error() {
	echo -e "\033[1;31m$@\033[m" 1>&2
}

#----- MAIN FUNCTION -----#
function main {
	show_info 'What would you like to do?'
	echo
	# echo "0) Perform system update and upgrade?"
	echo "1) Install favourite applications?"
	echo "2) Change apps behaviour and appearance?"
	echo "3) Perform dconf configurations?"
	echo
	echo "5) View hardware information?"
	echo "6) Cleanup the system?"
	echo
	echo "e) Exit?"
	echo
	show_info 'Enter your choice:' && read REPLY
	case $REPLY in
		# 0) sysupgrade;;              # System Upgrade
		1) clear && applications;;   # Install apps
		2) clear && fix-apps;;       # Fix apps
		3) clear && dconf-settings;; # Dconf config
		5) clear && hardware;;       # Hardware info
		6) clear && cleanup;;        # System cleanup
		[Ee]* ) exit 99;;            # Quit
		[Qq]* ) exit 99;;            # Quit
		* ) clear && show_error 'Not an option, try again.' && main;;
	esac
}

#----- RUN MAIN FUNCTION -----#
main

# END OF SCRIPT
